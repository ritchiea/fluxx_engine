- if @skip_wrapper
  = render :partial => @template,  :locals => {:model => @model}
- else
  %div{:id=>"card-header"}= raw "#{raw flash_info} #{raw flash_error}"

  %div{:id=>"card-body"}
    %div.show
      = render :partial => @template, :locals => { :model => @model }
  - if !@skip_card_footer
    - if @related && ! @exclude_related_data
      %ol{:id=>"card-drawer"}
        - @related.each do |rd|
          %li.section
            - if rd[:lazy_load_url]
              %span.label{:class => "lazy-load", "data-src".to_sym => rd[:lazy_load_url]}
                = rd[:display_name]
              %ol.entries
            - else
              %span.label= rd[:display_name]
              %ol.entries
                - rd[:formatted_data].each do |element|
                  - section_title = if element[:display_template]
                    - render :partial => element[:display_template], :locals => {:model => element[:model]}
                  - else
                    - element[:model].to_s
                  %li.entry
                    = link_to((element[:model_url] || element[:model]), :class => 'new-detail', 'data-insert' => 'after', 'title' => truncate(element[:title], :length => 45)) do
                      %span= section_title
